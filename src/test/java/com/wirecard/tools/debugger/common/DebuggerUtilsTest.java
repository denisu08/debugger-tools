package com.wirecard.tools.debugger.common;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.MapperFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.jcraft.jsch.ChannelExec;
import com.jcraft.jsch.JSch;
import com.jcraft.jsch.Session;
import org.json.simple.JSONObject;
import org.junit.jupiter.api.Test;
import org.springframework.util.StringUtils;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.Hashtable;
import java.util.List;
import java.util.Map;
import java.util.concurrent.atomic.AtomicInteger;

public class DebuggerUtilsTest {

    private static ObjectMapper om;

    static {
        DebuggerUtilsTest.om = new ObjectMapper().configure(MapperFeature.USE_ANNOTATIONS, true);
    }

    enum NODE_TYPE {
        SINGLE,
        CONDITION,
        LOOP,
        LOOP_WITH_PAGING,
        MULTITHREAD
    }

    @Test
    public void testDecompile() throws Exception {
        /*Map<String, Map<Integer, String>> sourceMap = DebuggerUtils.getSourceMap("12345", "testBundle/ProcessFlow_aldis_menuFlow-service-1.0.jar");
        System.out.println("sourceMap: " + sourceMap);*/
    }

    @Test
    public void testTailLogger() throws Exception {
        String usr = "root";
        String host = "10.10.230.202";
        String password = "password";
        JSch jsch = new JSch();
        Session session = jsch.getSession(usr, host);
        String pwd = password;
        session.setPassword(pwd);
        Hashtable<String, String> config = new Hashtable<String, String>();
        config.put("StrictHostKeyChecking", "no");
        session.setConfig(config);
        session.connect(15000);
        session.setServerAliveInterval(15000);


        ChannelExec m_channelExec = (ChannelExec) session.openChannel("exec");
        String cmd = "tail -f /root/MicroService/processflow_pcratmandbranchnetworkflow_1.0_4073/jar_run/nohup.out";
        m_channelExec.setCommand(cmd);
        InputStream m_in = m_channelExec.getInputStream();
        m_channelExec.connect();
        BufferedReader m_bufferedReader = new BufferedReader(new InputStreamReader(m_in));
        boolean needToRead = true;
        while (needToRead) {
            if (m_bufferedReader.ready()) {
                String line = m_bufferedReader.readLine();
                System.out.println(line);
            }
            Thread.sleep(100);
        }
        m_bufferedReader.close();
        m_channelExec.sendSignal("SIGINT");
        m_channelExec.disconnect();
        session.disconnect();
        System.out.println("exit");
    }

    // @Test
    public void testGenerateNode() throws JsonProcessingException {
        List<Map> nodeDataFunctions = new ArrayList<>();
        List<Map> linkDataFunctions = new ArrayList<>();

        AtomicInteger nodeCounter = new AtomicInteger(0);
        AtomicInteger linkCounter = new AtomicInteger(0);
        String pfgString = "{\"_id\":\"43fc662c-2c61-475f-8c02-5760e6d6088f\",\"name\":\"PCCCUAccountPortfolioDisplayOptionBalanceDownloadFlow\",\"type\":\"CU\",\"processFlowType\":\"menu\",\"mode\":\"ADVANCE\",\"description\":\"PCC CU Account Portfolio Display Option Balance Download Flow\\n\\n\",\"timeout\":\"30000\",\"propagation\":\"SUPPORTS\",\"structureGrouping\":[{\"finallyMicroServices\":[],\"output\":[{\"isOutput\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"idx\":0},{\"isOutput\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"idx\":1},{\"isOutput\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"idx\":2},{\"isOutput\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"idx\":3},{\"isOutput\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"idx\":4},{\"isOutput\":\"Y\",\"name\":\"fileFormatterMap\",\"type\":\"List\",\"idx\":5},{\"name\":\"structure\",\"type\":\"String\",\"idx\":6},{\"name\":\"accountList\",\"type\":\"List\",\"idx\":7},{\"name\":\"accountMap\",\"type\":\"Map\",\"idx\":8},{\"isOutput\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"idx\":9},{\"name\":\"publicKeyPGP\",\"type\":\"String\",\"idx\":10},{\"name\":\"privateKeyPGP\",\"type\":\"String\",\"idx\":11},{\"name\":\"passphrasePGP\",\"type\":\"String\",\"idx\":12}],\"input\":[{\"isInput\":\"Y\",\"isManual\":\"Y\",\"name\":\"fileFormatterId\",\"type\":\"String\",\"idx\":0,\"isMandatory\":\"Y\"},{\"isInput\":\"N\",\"isManual\":\"Y\",\"name\":\"fileFormatterMap\",\"type\":\"List\",\"idx\":1,\"isMandatory\":\"N\"},{\"isInput\":\"Y\",\"isManual\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"idx\":2,\"isMandatory\":\"N\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"locale\",\"type\":\"String\",\"idx\":3,\"isMandatory\":\"N\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"searchBy\",\"type\":\"String\",\"idx\":4,\"isMandatory\":\"Y\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"accountList\",\"type\":\"List\",\"idx\":5,\"isMandatory\":\"N\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"displayCurrency\",\"type\":\"String\",\"idx\":6,\"isMandatory\":\"N\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"groupBy1\",\"type\":\"String\",\"idx\":7,\"isMandatory\":\"Y\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"groupBy2\",\"type\":\"String\",\"idx\":8,\"isMandatory\":\"Y\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"filename\",\"type\":\"String\",\"idx\":9,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"ext\",\"type\":\"String\",\"idx\":10,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"content\",\"type\":\"Text\",\"idx\":11,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"isSuccess\",\"type\":\"String\",\"idx\":12,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"listContent\",\"type\":\"List\",\"idx\":13,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountAlias\",\"type\":\"String\",\"idx\":14,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountCurrencyName\",\"type\":\"String\",\"idx\":15,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"tenant\",\"type\":\"String\",\"idx\":16,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountNo\",\"type\":\"String\",\"idx\":17,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountBranch\",\"type\":\"String\",\"idx\":18,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountTypeName\",\"type\":\"String\",\"idx\":19,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountName\",\"type\":\"String\",\"idx\":20,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountBranchName\",\"type\":\"String\",\"idx\":21,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"_id\",\"type\":\"String\",\"idx\":22,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountCurrency\",\"type\":\"String\",\"idx\":23,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"accountStatus\",\"type\":\"String\",\"idx\":24,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"publicKeyPGP\",\"type\":\"String\",\"idx\":25,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"privateKeyPGP\",\"type\":\"String\",\"idx\":26,\"isMandatory\":\"N\"},{\"isInput\":\"N\",\"isManual\":\"N\",\"name\":\"passphrasePGP\",\"type\":\"String\",\"idx\":27,\"isMandatory\":\"N\"},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"accountType\",\"type\":null,\"idx\":28,\"isMandatory\":null},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"consolidatedFormat\",\"type\":null,\"idx\":29,\"isMandatory\":null},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"archiveFlag\",\"type\":null,\"idx\":30,\"isMandatory\":null},{\"isInput\":\"Y\",\"isManual\":\"N\",\"name\":\"encryptionType\",\"type\":null,\"idx\":31,\"isMandatory\":null}],\"code\":\"BASE\",\"microServices\":[{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"accountType\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"inn\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"accountType\"}}},\"asyncFlag\":false,\"detail\":[{\"method\":\"getAccountListByAccountType\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[{\"id\":\"user session\",\"text\":\"User Session\",\"type\":\"SESSION\"}],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"searchBy\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"searchBy\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"corpId\",\"name\":\"corporateId\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"userId\",\"name\":\"userId\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountType\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountType\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"searchBy\",\"type\":\"String\",\"key\":\"searchBy\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"corpId\",\"name\":\"corporateId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"userId\",\"name\":\"userId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountType\",\"type\":\"String\",\"key\":\"accountType\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"},{\"appendToResult\":\"Y\",\"name\":\"accountList\",\"type\":\"List\",\"key\":\"accountList\"}],\"asyncFlag\":false,\"topic\":\"pccuaccountportfolioservice\",\"catch\":[]}],\"catch\":[]},{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"consolidatedFormat\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"N\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"consolidatedFormat\"}}},\"asyncFlag\":false,\"detail\":[{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"archiveFlag\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"Y\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"archiveFlag\"}}},\"asyncFlag\":false,\"detail\":[{\"groupType\":\"loop\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"listMap\",\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"accountList\"}],\"outputKey\":\"\",\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"loopMap\",\"type\":\"Map\",\"key\":\"accountMap\"}],\"groupMapping\":{\"attributes\":[{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"listMap\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"accountList\",\"attributeParams\":[]}]},\"asyncFlag\":false,\"detail\":[{\"method\":\"getAccountListDisplayOptionBalanceDownload\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"searchBy\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"searchBy\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"corpName\",\"name\":\"corporateName\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountAlias\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountAlias\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountType\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountType\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountCurrencyName\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountCurrencyName\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"tenant\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"tenant\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountNo\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountNo\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountBranch\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountBranch\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountTypeName\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountTypeName\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountName\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountName\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountBranchName\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountBranchName\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"_id\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"_id\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountCurrency\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountCurrency\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountStatus\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountStatus\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"consolidatedFormat\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"consolidatedFormat\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"corpId\",\"name\":\"corporateId\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"userId\",\"name\":\"userId\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"channel\",\"name\":\"channel\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"displayCurrency\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"displayCurrency\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"groupBy1\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"groupBy1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"groupBy2\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"groupBy2\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"dateFormat\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"Date Format~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"channelTenantId\",\"name\":\"channelTenantId\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"loanTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Loan Account Type Code~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"timeDepositTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Time Deposit Account Type Code~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"savingTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Saving Account Type Code~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"currentTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Currenct Account Type Code~1.-1\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"searchBy\",\"type\":\"String\",\"key\":\"searchBy\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"corpName\",\"name\":\"corporateName\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountAlias\",\"type\":\"String\",\"key\":\"accountAlias\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountType\",\"type\":\"String\",\"key\":\"accountType\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountCurrencyName\",\"type\":\"String\",\"key\":\"accountCurrencyName\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"tenant\",\"type\":\"String\",\"key\":\"tenant\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountNo\",\"type\":\"String\",\"key\":\"accountNo\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountBranch\",\"type\":\"String\",\"key\":\"accountBranch\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountTypeName\",\"type\":\"String\",\"key\":\"accountTypeName\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountName\",\"type\":\"String\",\"key\":\"accountName\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountBranchName\",\"type\":\"String\",\"key\":\"accountBranchName\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"_id\",\"type\":\"String\",\"key\":\"_id\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountCurrency\",\"type\":\"String\",\"key\":\"accountCurrency\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountStatus\",\"type\":\"String\",\"key\":\"accountStatus\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"consolidatedFormat\",\"type\":\"String\",\"key\":\"consolidatedFormat\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"corpId\",\"name\":\"corporateId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"userId\",\"name\":\"userId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountList\",\"type\":\"List\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"channel\",\"name\":\"channel\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"displayCurrency\",\"type\":\"String\",\"key\":\"displayCurrency\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"groupBy1\",\"type\":\"String\",\"key\":\"groupBy1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"groupBy2\",\"type\":\"String\",\"key\":\"groupBy2\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"dateFormat\",\"type\":\"String\",\"key\":\"Date Format~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"channelTenantId\",\"name\":\"channelTenantId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"loanTypeCode\",\"type\":\"String\",\"key\":\"Loan Account Type Code~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"timeDepositTypeCode\",\"type\":\"String\",\"key\":\"Time Deposit Account Type Code~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"savingTypeCode\",\"type\":\"String\",\"key\":\"Saving Account Type Code~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"currentTypeCode\",\"type\":\"String\",\"key\":\"Currenct Account Type Code~1.-1\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"N\",\"isCondition\":null,\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isCondition\":null,\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"N\",\"isCondition\":null,\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"},{\"appendToResult\":\"Y\",\"isCondition\":null,\"name\":\"collectData\",\"type\":\"List\",\"key\":\"fileFormatterMap\"}],\"asyncFlag\":false,\"topic\":\"pccuaccountportfolioservice\",\"catch\":[]},{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"encryptionType\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"Y\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"encryptionType\"}}},\"asyncFlag\":false,\"detail\":[{\"method\":\"getBankEncryptionKey\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"},{\"appendToResult\":\"Y\",\"name\":\"publicKeyPGP\",\"type\":\"String\",\"key\":\"publicKeyPGP\"},{\"appendToResult\":\"Y\",\"name\":\"privateKeyPGP\",\"type\":\"String\",\"key\":\"privateKeyPGP\"},{\"appendToResult\":\"Y\",\"name\":\"passphrasePGP\",\"type\":\"String\",\"key\":\"passphrasePGP\"}],\"asyncFlag\":false,\"topic\":\"bankencryptionkeyservice\",\"catch\":[]},{\"awaitFlag\":false,\"builtinFunction\":\"mapFileFormatterList\",\"finally\":[],\"builtinMapping\":{\"parameter\":{\"ACCOUNT_BALANCE_CUSTOM_V_LATEST_BASE\":{\"name\":\"Account Balance Custom PDF , XLSX (Ver Latest)\",\"attributes\":[{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field1\",\"attributeValue\":\"corporateName\",\"dataType\":\"alphaNumeric\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field2\",\"attributeValue\":\"accountListCASA\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field3\",\"attributeValue\":\"accountListLoan\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field4\",\"attributeValue\":\"accountListTimeDeposit\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false}]}},\"formatTypeBy\":\"map\",\"attributes\":[{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterMap\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterMap\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"filename\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"filename\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"structure\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"structure\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterId\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterId\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"Y\",\"name\":\"historyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"Path file history download~1.-1\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"locale\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"locale\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionAlgorithm\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"pgp\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"encryptionKey\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"passphrasePGP\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"encryptionPublicKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"publicKeyPGP\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"encryptionPrivateKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"privateKeyPGP\",\"attributeParams\":[]}],\"formatType\":\"download\",\"uploadTypeBy\":\"content\"},\"type\":\"single\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[{\"id\":\"path file history download\",\"text\":\"Path file history download\",\"type\":\"CONSTANT\"}],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterMap\",\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"fileFormatterMap\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"filename\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"structure\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterId\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"fileFormatterId\"},{\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"historyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Path file history download~1.-1\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"locale\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"locale\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"encryptionKey\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"passphrasePGP\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"encryptionPublicKeyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"publicKeyPGP\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"encryptionPrivateKeyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"privateKeyPGP\"}],\"outputKey\":\"\",\"appendResultList\":[],\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterMap\",\"type\":\"List\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterContent\",\"type\":\"Text\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"locale\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"flowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"rollbackFlowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"key\":\"content\"},{\"appendToResult\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\"},{\"appendToResult\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\"},{\"appendToResult\":\"N\",\"name\":\"fileMapping\",\"type\":\"List\",\"key\":\"fileMapping\"},{\"appendToResult\":\"N\",\"name\":\"fileUploadId\",\"type\":\"String\",\"key\":\"fileUploadId\"},{\"appendToResult\":\"N\",\"name\":\"filesize\",\"type\":\"Integer\",\"key\":\"filesize\"},{\"appendToResult\":\"N\",\"name\":\"filesizeDisplay\",\"type\":\"String\",\"key\":\"filesizeDisplay\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"innerType\":\"\",\"catch\":[],\"builtinFunctionVersion\":\"1.0\"}],\"catch\":[]},{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"encryptionType\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"N\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"encryptionType\"}}},\"asyncFlag\":false,\"detail\":[{\"awaitFlag\":false,\"builtinFunction\":\"mapFileFormatterList\",\"finally\":[],\"builtinMapping\":{\"parameter\":{\"ACCOUNT_BALANCE_CUSTOM_V_LATEST_BASE\":{\"name\":\"Account Balance Custom PDF , XLSX (Ver Latest)\",\"attributes\":[{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field1\",\"attributeValue\":\"corporateName\",\"dataType\":\"alphaNumeric\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field2\",\"attributeValue\":\"accountListCASA\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field3\",\"attributeValue\":\"accountListLoan\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field4\",\"attributeValue\":\"accountListTimeDeposit\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false}]}},\"formatTypeBy\":\"map\",\"attributes\":[{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterMap\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterMap\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"filename\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"filename\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"structure\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"structure\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterId\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterId\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"Y\",\"name\":\"historyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"Path file history download~1.-1\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"locale\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"locale\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionAlgorithm\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionKey\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionPublicKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionPrivateKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]}],\"formatType\":\"download\",\"uploadTypeBy\":\"content\"},\"type\":\"single\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[{\"id\":\"path file history download\",\"text\":\"Path file history download\",\"type\":\"CONSTANT\"}],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterMap\",\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"fileFormatterMap\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"filename\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"structure\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterId\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"fileFormatterId\"},{\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"historyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Path file history download~1.-1\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"locale\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"locale\"}],\"outputKey\":\"\",\"appendResultList\":[],\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterMap\",\"type\":\"List\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterContent\",\"type\":\"Text\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"locale\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"flowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"rollbackFlowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"key\":\"content\"},{\"appendToResult\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\"},{\"appendToResult\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\"},{\"appendToResult\":\"N\",\"name\":\"fileMapping\",\"type\":\"List\",\"key\":\"fileMapping\"},{\"appendToResult\":\"N\",\"name\":\"fileUploadId\",\"type\":\"String\",\"key\":\"fileUploadId\"},{\"appendToResult\":\"N\",\"name\":\"filesize\",\"type\":\"Integer\",\"key\":\"filesize\"},{\"appendToResult\":\"N\",\"name\":\"filesizeDisplay\",\"type\":\"String\",\"key\":\"filesizeDisplay\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"innerType\":\"\",\"catch\":[],\"builtinFunctionVersion\":\"1.0\"}],\"catch\":[]},{\"method\":\"addAccountMap\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[{\"id\":\"cu menu account portfolio_v1_0\",\"text\":\"CU Menu Account Portfolio\",\"type\":\"CONSTANT\"}],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"ext\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"accountNo\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"isMandatory\":\"N\",\"key\":\"content\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"isSuccess\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"listContent\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"menuName\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"CU Menu Account Portfolio~1.-1\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"accountNo\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"key\":\"content\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"menuName\",\"type\":\"String\",\"key\":\"CU Menu Account Portfolio~1.-1\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"N\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\"},{\"appendToResult\":\"N\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"N\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"topic\":\"pccutransactioninquiryservice\",\"catch\":[]}],\"catch\":[]}],\"catch\":[]},{\"method\":\"setDownloadPropertiesForZip\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"listContent\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"filename\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\"},{\"appendToResult\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\"},{\"appendToResult\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"topic\":\"pccutransactioninquiryservice\",\"catch\":[]}],\"catch\":[]},{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"consolidatedFormat\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"Y\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"consolidatedFormat\"}}},\"asyncFlag\":false,\"detail\":[{\"method\":\"getAccountListDisplayOptionBalanceDownload\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"searchBy\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"searchBy\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"corpName\",\"name\":\"corporateName\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"consolidatedFormat\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"consolidatedFormat\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"corpId\",\"name\":\"corporateId\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"userId\",\"name\":\"userId\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"accountList\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"accountList\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"channel\",\"name\":\"channel\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"displayCurrency\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"displayCurrency\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"groupBy1\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"groupBy1\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"groupBy2\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"groupBy2\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"dateFormat\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"Date Format~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"sessionAttribute\":\"channelTenantId\",\"name\":\"channelTenantId\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"User Session~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"loanTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Loan Account Type Code~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"timeDepositTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Time Deposit Account Type Code~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"savingTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Saving Account Type Code~1.-1\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"currentTypeCode\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Currenct Account Type Code~1.-1\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"searchBy\",\"type\":\"String\",\"key\":\"searchBy\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"corpName\",\"name\":\"corporateName\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountAlias\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountType\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountCurrencyName\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"tenant\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountNo\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountBranch\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountTypeName\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountName\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountBranchName\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"_id\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountCurrency\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"accountStatus\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"consolidatedFormat\",\"type\":\"String\",\"key\":\"consolidatedFormat\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"corpId\",\"name\":\"corporateId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"userId\",\"name\":\"userId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"accountList\",\"type\":\"List\",\"key\":\"accountList\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"channel\",\"name\":\"channel\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"displayCurrency\",\"type\":\"String\",\"key\":\"displayCurrency\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"groupBy1\",\"type\":\"String\",\"key\":\"groupBy1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"groupBy2\",\"type\":\"String\",\"key\":\"groupBy2\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"dateFormat\",\"type\":\"String\",\"key\":\"Date Format~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"sessionAttribute\":\"channelTenantId\",\"name\":\"channelTenantId\",\"type\":\"String\",\"key\":\"User Session~1.-1\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"loanTypeCode\",\"type\":\"String\",\"key\":\"Loan Account Type Code~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"timeDepositTypeCode\",\"type\":\"String\",\"key\":\"Time Deposit Account Type Code~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"savingTypeCode\",\"type\":\"String\",\"key\":\"Saving Account Type Code~1.-1\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"currentTypeCode\",\"type\":\"String\",\"key\":\"Currenct Account Type Code~1.-1\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"N\",\"isCondition\":null,\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isCondition\":null,\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"N\",\"isCondition\":null,\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"},{\"appendToResult\":\"Y\",\"isCondition\":null,\"name\":\"collectData\",\"type\":\"List\",\"key\":\"fileFormatterMap\"}],\"asyncFlag\":false,\"topic\":\"pccuaccountportfolioservice\",\"catch\":[]},{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"encryptionType\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"N\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"encryptionType\"}}},\"asyncFlag\":false,\"detail\":[{\"awaitFlag\":false,\"builtinFunction\":\"mapFileFormatterList\",\"finally\":[],\"builtinMapping\":{\"parameter\":{\"ACCOUNT_BALANCE_CUSTOM_V_LATEST_BASE\":{\"name\":\"Account Balance Custom PDF , XLSX (Ver Latest)\",\"attributes\":[{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field1\",\"attributeValue\":\"corporateName\",\"dataType\":\"alphaNumeric\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field2\",\"attributeValue\":\"accountListCASA\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field3\",\"attributeValue\":\"accountListLoan\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field4\",\"attributeValue\":\"accountListTimeDeposit\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false}]}},\"formatTypeBy\":\"map\",\"attributes\":[{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterMap\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterMap\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"filename\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"filename\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"structure\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"structure\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterId\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterId\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"Y\",\"name\":\"historyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"Path file history download~1.-1\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"locale\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"locale\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionAlgorithm\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionKey\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionPublicKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionPrivateKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"\",\"attributeParams\":[]}],\"formatType\":\"download\",\"uploadTypeBy\":\"content\"},\"type\":\"single\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[{\"id\":\"path file history download\",\"text\":\"Path file history download\",\"type\":\"CONSTANT\"}],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterMap\",\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"fileFormatterMap\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"filename\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"structure\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterId\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"fileFormatterId\"},{\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"historyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Path file history download~1.-1\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"locale\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"locale\"}],\"outputKey\":\"\",\"appendResultList\":[],\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterMap\",\"type\":\"List\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterContent\",\"type\":\"Text\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"locale\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"flowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"rollbackFlowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"key\":\"content\"},{\"appendToResult\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\"},{\"appendToResult\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\"},{\"appendToResult\":\"N\",\"name\":\"fileMapping\",\"type\":\"List\",\"key\":\"fileMapping\"},{\"appendToResult\":\"N\",\"name\":\"fileUploadId\",\"type\":\"String\",\"key\":\"fileUploadId\"},{\"appendToResult\":\"N\",\"name\":\"filesize\",\"type\":\"Integer\",\"key\":\"filesize\"},{\"appendToResult\":\"N\",\"name\":\"filesizeDisplay\",\"type\":\"String\",\"key\":\"filesizeDisplay\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"innerType\":\"\",\"catch\":[],\"builtinFunctionVersion\":\"1.0\"}],\"catch\":[]},{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"encryptionType\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"Y\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"encryptionType\"}}},\"asyncFlag\":false,\"detail\":[{\"method\":\"getBankEncryptionKey\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"},{\"appendToResult\":\"Y\",\"name\":\"publicKeyPGP\",\"type\":\"String\",\"key\":\"publicKeyPGP\"},{\"appendToResult\":\"Y\",\"name\":\"privateKeyPGP\",\"type\":\"String\",\"key\":\"privateKeyPGP\"},{\"appendToResult\":\"Y\",\"name\":\"passphrasePGP\",\"type\":\"String\",\"key\":\"passphrasePGP\"}],\"asyncFlag\":false,\"topic\":\"bankencryptionkeyservice\",\"catch\":[]},{\"awaitFlag\":false,\"builtinFunction\":\"mapFileFormatterList\",\"finally\":[],\"builtinMapping\":{\"parameter\":{\"ACCOUNT_BALANCE_CUSTOM_V_LATEST_BASE\":{\"name\":\"Account Balance Custom PDF , XLSX (Ver Latest)\",\"attributes\":[{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field1\",\"attributeValue\":\"corporateName\",\"dataType\":\"alphaNumeric\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field2\",\"attributeValue\":\"accountListCASA\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field3\",\"attributeValue\":\"accountListLoan\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false},{\"appendToResult\":false,\"isVar\":false,\"isSystem\":false,\"fieldName\":\"field4\",\"attributeValue\":\"accountListTimeDeposit\",\"dataType\":\"list\",\"attributeValues\":[],\"isFlow\":false,\"processFlowType\":\"\",\"isPage\":false,\"attributeParams\":[],\"isMandatory\":false}]}},\"formatTypeBy\":\"map\",\"attributes\":[{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterMap\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterMap\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"filename\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"filename\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"structure\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"structure\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"fileFormatterId\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"fileFormatterId\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"Y\",\"name\":\"historyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"Path file history download~1.-1\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"locale\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"locale\",\"attributeParams\":[]},{\"isVar\":\"N\",\"isSystem\":\"N\",\"name\":\"encryptionAlgorithm\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"pgp\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"encryptionKey\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"passphrasePGP\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"encryptionPublicKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"publicKeyPGP\",\"attributeParams\":[]},{\"isVar\":\"Y\",\"isSystem\":\"N\",\"name\":\"encryptionPrivateKeyPath\",\"attributeValues\":[],\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"isPage\":\"N\",\"key\":\"privateKeyPGP\",\"attributeParams\":[]}],\"formatType\":\"download\",\"uploadTypeBy\":\"content\"},\"type\":\"single\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[{\"id\":\"path file history download\",\"text\":\"Path file history download\",\"type\":\"CONSTANT\"}],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterMap\",\"isFlow\":\"N\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"fileFormatterMap\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"filename\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"structure\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"fileFormatterId\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"fileFormatterId\"},{\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"historyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"Path file history download~1.-1\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"locale\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"locale\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"encryptionKey\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"passphrasePGP\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"encryptionPublicKeyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"publicKeyPGP\"},{\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"encryptionPrivateKeyPath\",\"isFlow\":\"N\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"privateKeyPGP\"}],\"outputKey\":\"\",\"appendResultList\":[],\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterMap\",\"type\":\"List\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterContent\",\"type\":\"Text\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"fileFormatterId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"locale\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"flowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"N\",\"isInput\":\"N\",\"name\":\"rollbackFlowId\",\"type\":\"String\",\"key\":\"\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"key\":\"content\"},{\"appendToResult\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\"},{\"appendToResult\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\"},{\"appendToResult\":\"N\",\"name\":\"fileMapping\",\"type\":\"List\",\"key\":\"fileMapping\"},{\"appendToResult\":\"N\",\"name\":\"fileUploadId\",\"type\":\"String\",\"key\":\"fileUploadId\"},{\"appendToResult\":\"N\",\"name\":\"filesize\",\"type\":\"Integer\",\"key\":\"filesize\"},{\"appendToResult\":\"N\",\"name\":\"filesizeDisplay\",\"type\":\"String\",\"key\":\"filesizeDisplay\"},{\"appendToResult\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"Y\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"innerType\":\"\",\"catch\":[],\"builtinFunctionVersion\":\"1.0\"}],\"catch\":[]},{\"groupType\":\"condition\",\"awaitFlag\":false,\"finally\":[],\"type\":\"group\",\"ignoreErrorFlag\":false,\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"inputList\":[{\"isSystem\":\"N\",\"isVar\":\"Y\",\"isFlow\":\"N\",\"isPage\":\"N\",\"key\":\"archiveFlag\"}],\"outputKey\":\"\",\"responseMapping\":[],\"groupMapping\":{\"mode\":\"simple\",\"simpleCondition\":{\"condition\":\"eq\",\"rightClause\":{\"isVar\":\"N\",\"isSystem\":\"N\",\"key\":\"Y\"},\"leftClause\":{\"isVar\":\"Y\",\"isSystem\":\"N\",\"key\":\"archiveFlag\"}}},\"asyncFlag\":false,\"detail\":[{\"method\":\"addAccountMap\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[{\"id\":\"cu menu account portfolio_v1_0\",\"text\":\"CU Menu Account Portfolio\",\"type\":\"CONSTANT\"}],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"ext\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"filename\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"isMandatory\":\"N\",\"key\":\"content\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"isSuccess\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"listContent\"},{\"appendToResult\":\"N\",\"isSystem\":\"Y\",\"isVar\":\"N\",\"name\":\"menuName\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"CU Menu Account Portfolio~1.-1\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"content\",\"type\":\"Text\",\"key\":\"content\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"N\",\"isSystem\":\"Y\",\"isInput\":\"Y\",\"name\":\"menuName\",\"type\":\"String\",\"key\":\"CU Menu Account Portfolio~1.-1\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"N\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\"},{\"appendToResult\":\"N\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"N\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"topic\":\"pccutransactioninquiryservice\",\"catch\":[]},{\"method\":\"setDownloadPropertiesForZip\",\"awaitFlag\":false,\"finally\":[],\"httpMethod\":\"POST\",\"type\":\"single\",\"ignoreErrorFlag\":false,\"version\":\"1.-1\",\"builtinParameter\":{\"menuList\":[],\"menuPageList\":[],\"systemParameterList\":[],\"flowList\":[]},\"isEureka\":\"N\",\"inputList\":[{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"isMandatory\":\"Y\",\"key\":\"structure\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"isMandatory\":\"N\",\"key\":\"listContent\"},{\"appendToResult\":\"N\",\"isSystem\":\"N\",\"isVar\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"isMandatory\":\"N\",\"key\":\"filename\"}],\"outputKey\":\"\",\"appendResultList\":[],\"deployAs\":\"Library\",\"requestMapping\":[{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\",\"isMandatory\":\"Y\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\",\"isMandatory\":\"N\"},{\"appendToResult\":\"N\",\"isVar\":\"Y\",\"isSystem\":\"N\",\"isInput\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\",\"isMandatory\":\"N\"}],\"responseMapping\":[{\"appendToResult\":\"Y\",\"name\":\"structure\",\"type\":\"String\",\"key\":\"structure\"},{\"appendToResult\":\"Y\",\"name\":\"ext\",\"type\":\"String\",\"key\":\"ext\"},{\"appendToResult\":\"Y\",\"name\":\"filename\",\"type\":\"String\",\"key\":\"filename\"},{\"appendToResult\":\"Y\",\"name\":\"listContent\",\"type\":\"List\",\"key\":\"listContent\"},{\"appendToResult\":\"N\",\"name\":\"isSuccess\",\"type\":\"String\",\"key\":\"isSuccess\"},{\"appendToResult\":\"N\",\"name\":\"message\",\"type\":\"String\",\"key\":\"message\"}],\"asyncFlag\":false,\"topic\":\"pccutransactioninquiryservice\",\"catch\":[]}],\"catch\":[]}],\"catch\":[]}],\"name\":\"Base\",\"description\":\"Base Structure\"}],\"versionMajor\":\"1\",\"versionMinor\":\"8\",\"developmentStatus\":\"Freeze\",\"developmentId\":[\"PCC_0.0.1.23\",\"PCC_0.0.1.24\"],\"createdDate\":\"2019-11-22T12:48:56.389Z\",\"createdBy\":\"Verawati\",\"updatedDate\":\"2019-11-22T13:03:30.014Z\",\"updatedBy\":\"Verawati\",\"_class\":\"com.wirecard.wms.configurator.model.ProcessFlow\"}";
        JSONObject dataJSON = DebuggerUtilsTest.om.readValue(pfgString, JSONObject.class);

        System.out.println("start:");
        WMSNode startNode = WMSNode.createStartNode();
        WMSNode endNode = WMSNode.createEndNode();

        WMSNode latestNode = null;
        List<Map> structureGroupingList = (List<Map>) dataJSON.get("structureGrouping");
        for (Map structureGroupMap : structureGroupingList) {
            List<Map> microserviceList = (List<Map>) structureGroupMap.get("microServices");
            int counter = 1;
            latestNode = startNode;
            for (Map microserviceMap : microserviceList) {
                WMSNode childNode = recursiveMicroServiceChild(nodeDataFunctions, linkDataFunctions, nodeCounter, linkCounter, microserviceMap, latestNode, String.format("%s", counter++), false);
                // this.createLink(linkCounter, latestNode, childNode, false);
                latestNode = childNode;
            }
        }
        new WMSLink(linkCounter.getAndIncrement(), latestNode.getKey(), endNode.getKey(), "terminate");
    }

    // return parent node
    private WMSNode recursiveMicroServiceChild(List<Map> nodeDataFunctions, List<Map> linkDataFunctions, AtomicInteger nodeCounter, AtomicInteger linkCounter, Map microserviceMap, WMSNode previousNode, String routerText, boolean isOverrideFlag) {
        WMSNode currentNode = previousNode;
        if ("group".equalsIgnoreCase((String) microserviceMap.get("type"))) {
            String groupType = (String) microserviceMap.get("groupType");
            if ("condition".equalsIgnoreCase(groupType)) {
                System.out.println(routerText + ": at condition");
                currentNode = this.createNode(nodeDataFunctions, nodeCounter, microserviceMap, NODE_TYPE.CONDITION);
                this.createLink(linkDataFunctions, linkCounter, previousNode, currentNode, isOverrideFlag);
            } else if ("loop".equalsIgnoreCase(groupType)) {
                System.out.println(routerText + ": at loop");
                currentNode = this.createNode(nodeDataFunctions, nodeCounter, microserviceMap, NODE_TYPE.LOOP);
                this.createLink(linkDataFunctions, linkCounter, previousNode, currentNode, isOverrideFlag);
            } else if ("loopWithPaging".equalsIgnoreCase(groupType)) {
                System.out.println(routerText + ": at loopWithPaging");
                currentNode = this.createNode(nodeDataFunctions, nodeCounter, microserviceMap, NODE_TYPE.LOOP_WITH_PAGING);
                this.createLink(linkDataFunctions, linkCounter, previousNode, currentNode, isOverrideFlag);
            } else if ("multithread".equalsIgnoreCase(groupType)) {
                System.out.println(routerText + ": at multithread");
                currentNode = this.createNode(nodeDataFunctions, nodeCounter, microserviceMap, NODE_TYPE.MULTITHREAD);
                this.createLink(linkDataFunctions, linkCounter, previousNode, currentNode, isOverrideFlag);
            }

            WMSNode previousDetailNode = currentNode;
            List<Map> detailList = (List<Map>) microserviceMap.get("detail");
            int counter = 1;
            for (Map childServiceMap : detailList) {
                // System.out.println(routerText + ": at detail");
                WMSNode childNode = this.recursiveMicroServiceChild(nodeDataFunctions, linkDataFunctions, nodeCounter, linkCounter, childServiceMap, currentNode, String.format("%s.%s", routerText, counter++), true);
                if (counter > 2) {
                    this.createLink(linkDataFunctions, linkCounter, previousDetailNode, childNode, true);
                }
                previousDetailNode = childNode;
            }
        } else {
            System.out.println(routerText + ": at node");
            currentNode = this.createNode(nodeDataFunctions, nodeCounter, microserviceMap, NODE_TYPE.SINGLE);
            this.createLink(linkDataFunctions, linkCounter, previousNode, currentNode, true);
        }
        return currentNode;
    }

    private void setNodeInfo(Map service, WMSNode currentNode) {
        StringBuffer sb = new StringBuffer();
        sb.append("step: ${currentNode.key}");
        if (service.get("builtinFunction") != null) {
            sb.append("\nname: ${service.builtinFunction}");
        } else {
            sb.append("\nservice: ${service.topic}");
            sb.append("\nmethod: ${service.method}");
        }

        sb.append("\ntype: ${service.type}");
        sb.append("\nignoreErrorFlag: ${service.ignoreErrorFlag}");
        sb.append("\ndeployAs: ${service.deployAs}");
        sb.append("\nasyncFlag: ${service.asyncFlag}");
        if (service.get("groupType") != null) {
            sb.append("\ngroup: ${service.groupType}");
        } else {
            sb.append("\ngroup: ${service?.builtinFunction ? 'builtin' : 'service'}");
        }
        currentNode.getAdditionalInfo().put("helpInfo", sb.toString());
    }

    private WMSNode createNode(List<Map> nodeDataFunctions, AtomicInteger nodeCounter, Map microserviceMap, NODE_TYPE nodeType) {
        WMSNode currentNode = null;
        switch (nodeType) {
            case CONDITION:
                Map simpleCond = (Map) ((Map) microserviceMap.get("groupMapping")).get("simpleCondition");
                String condition = String.format("%s %s %s", ((Map) simpleCond.get("leftClause")).get("key"), simpleCond.get("condition"), ((Map) simpleCond.get("rightClause")).get("key"));
                currentNode = new WMSNode(nodeCounter.getAndIncrement(), condition, "category", "condition");
                break;
            case LOOP:
                List<Map> attributes = (List<Map>) ((Map) microserviceMap.get("groupMapping")).get("attributes");
                List<String> attributeList = new ArrayList<>();
                for (Map attrMap : attributes) {
                    attributeList.add((String) attrMap.get("key"));
                }
                String attributeText = String.format("iterate(%s)", String.join(",", attributeList));
                currentNode = new WMSNode(nodeCounter.getAndIncrement(), attributeText, "category", "loop");
                break;
            case LOOP_WITH_PAGING:
                break;
            case MULTITHREAD:
                break;
            default:
                String nodeName = StringUtils.hasText((String) microserviceMap.get("builtinFunction")) ? (String) microserviceMap.get("builtinFunction") : String.format("%s - %s", microserviceMap.get("topic"), microserviceMap.get("method"));
                currentNode = new WMSNode(nodeCounter.getAndIncrement(), nodeName, "category", microserviceMap.containsKey("builtinFunction") ? "builtin" : "service");
                break;
        }
        this.setNodeInfo(microserviceMap, currentNode);
        nodeDataFunctions.add(currentNode.convertToMap());
        return currentNode;
    }

    private WMSLink createLink(List<Map> linkDataFunctions, AtomicInteger linkCounter, WMSNode fromNode, WMSNode toNode, boolean isFlag) {
        List<String> additionalInfo = new ArrayList<>();
        String text = "call";
        if ("condition".equals(toNode.getAdditionalInfo().get("category"))) {
            text = "check";
        } else if ("loop".equals(toNode.getAdditionalInfo().get("category"))) {
            text = isFlag ? "start loop" : "loop";
        } else if ("loop".equals(fromNode.getAdditionalInfo().get("category"))) {
            text = isFlag ? "call" : "end loop";
        }

        if (!"startNode".equals(fromNode.getAdditionalInfo().get("category"))) {
            if ("condition".equals(fromNode.getAdditionalInfo().get("category"))) {
                additionalInfo.add("eval");
                additionalInfo.add(String.valueOf(isFlag));
            }
        }
        WMSLink newLink = new WMSLink(linkCounter.getAndIncrement(), fromNode.getKey(), toNode.getKey(), text, additionalInfo.toArray(new String[0]));
        linkDataFunctions.add(newLink.convertToMap());
        return newLink;
    }
}
